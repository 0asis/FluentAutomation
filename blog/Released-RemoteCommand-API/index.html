<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="author" content="Brandon Stirnaman" />
		<title>Fluent Automation // RELEASED: RemoteCommand API</title>

		<link href='/site.css' rel='stylesheet' />
		<link href='/pygments.css' rel='stylesheet' />

		<script type="text/javascript">
		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-26845406-1']);
		  _gaq.push(['_setDomainName', 'stirno.com']);
		  _gaq.push(['_trackPageview']);

		  (function() {
		    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();
		</script>
	</head>
	<body>
		<header>
			<a href='/'><h1>FLUENT<span>AUTOMATION</span></h1></a>
			<p class='who'><span class='blue'><a href='//twitter.com/stirno'>@stirno</a></span> // <a href='//github.com/stirno'>github.com/stirno</a></p>
			<p class='tagline'>Simple, fluent DSL for automating web applications.</p>
			<br />
			<nav>
				<a href='/docs' title='Get Started' class='tile double blue video'>
					<!-- <img src='/code-getting-started.gif' /> -->
					<iframe src="http://player.vimeo.com/video/52308617?title=0&amp;byline=0&amp;portrait=0&amp;autoplay=1&amp;loop=1" width="260" height="123" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
					<span>GETTING STARTED</span>
				</a>
				<a href='/docs' title='Read the Docs' class='tile red'>
					<div class='icon-docs'></div>
					<span>DOCUMENTATION</span>
				</a>
				<a href='//github.com/stirno/FluentAutomation' title='View on GitHub' class='tile purple left-spacer'>
					<div class='icon-github'></div>
					<span>VIEW ON GITHUB</span>
				</a>
				<div class='tile double orange'>
					<div class="nuget-badge">
					<p>
						<code>
							PM&gt; <a title='FluentAutomation.SeleniumWebDriver on NuGet' href='//nuget.org/packages/FluentAutomation.SeleniumWebDriver'>Install-Package FluentAutomation.SeleniumWebDriver</a><br /><br />
							PM&gt; <a title='FluentAutomation.WatiN on NuGet' href='//nuget.org/packages/FluentAutomation.WatiN'>Install-Package FluentAutomation.WatiN</a><br /><br />
							PM&gt; <a title='FluentAutomation.PhantomJS on NuGet' href='//nuget.org/packages/FluentAutomation.PhantomJS'>Install-Package FluentAutomation.PhantomJS</a>
						</code>
					</p>
					</div>
					<span>AVAILABLE ON NUGET</span>
				</div>
			</nav>		
<!-- 		<div class='clear'></div>
			<h1>FLUENT<span>AUTOMATION</span><span class='lighter'>recorder<span></h1>
			<p class='who'><span class='blue'><a href='//twitter.com/pauljz'>@pauljz</a></span> // <a href='//github.com/pauljz'>github.com/pauljz</a></p> -->
		</header>
		<section class='articles'>
			<article>
	<header title='RELEASED: RemoteCommand API'><a href='/blog/Released-RemoteCommand-API'>RELEASED: RemoteCommand API</a></header>
	<div class='clear'></div>
	<p>So we’ve talked about it before.. But now I’m ready to call it ‘released’ and I want to give this some more exposure because I think it will serve as the main testing method for most users very soon.</p>

<p>Scalability of UI automation tests is a big concern for development teams. The primary point of the RemoteCommand API is to allow tests to be run across multiple machines at once. There are a few solutions to this specific problem already including Selenium Server/Selenium Grid. Our alternative solution, to keep our abstraction in place, is to utilize the pieces that already exist in the Fluent framework to create our own test execution engine: FluentAutomation.Server.</p>

<p>As a proof-of-concept (PoC), we took the current bits and built a test coordinator application; coupled with a custom EC2 AMI and Amazon’s CloudWatch metrics, the PoC system scales up or down automatically based on tests in progress. It has worked better than we’d ever thought it would in this environment. Perfectly capable of testing on EC2 Micro images, we can utilize cost-effective services to test our applications.</p>

<p>With this, I want to talk about some of the limitations to this approach… First, the basics of how remote execution works. For managed bits such as the .NET API, you write your Fluent code as normal integration tests bundled in with the rest of your project. Very tidy and clean, an example test such as ..</p>
<div class="highlight"><pre><code class="csharp"><span class="n">I</span><span class="p">.</span><span class="n">Open</span><span class="p">(</span><span class="s">&quot;http://fluent.stirno.com&quot;</span><span class="p">);</span>
<span class="n">I</span><span class="p">.</span><span class="n">Expect</span><span class="p">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Blog&quot;</span><span class="p">).</span><span class="n">In</span><span class="p">(</span><span class="s">&quot;#menu-item-8 a&quot;</span><span class="p">);</span>
<span class="n">I</span><span class="p">.</span><span class="n">Click</span><span class="p">(</span><span class="s">&quot;#menu-item-8 a&quot;</span><span class="p">);</span>
<span class="n">I</span><span class="p">.</span><span class="n">Expect</span><span class="p">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;News&quot;</span><span class="p">).</span><span class="n">In</span><span class="p">(</span><span class="s">&quot;li.cat-item.cat-item-6 a&quot;</span><span class="p">);</span>
</code></pre>
</div>
<p>.. that opens a page, makes a few assertions, takes an action or two and completes; feels very natural. In either normal or remote execution modes this test will perform precisely the same steps in the same ways. Sometimes when writing a test you want to take an action only in the event of a failure. We see users commonly catching AssertExceptions and making decisions based on that. An example ..</p>
<div class="highlight"><pre><code class="csharp"><span class="n">I</span><span class="p">.</span><span class="n">Open</span><span class="p">(</span><span class="s">&quot;http://fluent.stirno.com&quot;</span><span class="p">);</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="n">I</span><span class="p">.</span><span class="n">Expect</span><span class="p">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Blogs&quot;</span><span class="p">).</span><span class="n">In</span><span class="p">(</span><span class="s">&quot;#menu-item-8 a&quot;</span><span class="p">);</span>
    <span class="n">I</span><span class="p">.</span><span class="n">Click</span><span class="p">(</span><span class="s">&quot;#menu-item-8 a&quot;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">AssertException</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">I</span><span class="p">.</span><span class="n">Expect</span><span class="p">.</span><span class="n">Text</span><span class="p">(</span><span class="s">&quot;Docs&quot;</span><span class="p">).</span><span class="n">In</span><span class="p">(</span><span class="s">&quot;#menu-item-236 a&quot;</span><span class="p">);</span>
    <span class="n">I</span><span class="p">.</span><span class="n">Click</span><span class="p">(</span><span class="s">&quot;#menu-item-236 a&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">I</span><span class="p">.</span><span class="n">Expect</span><span class="p">(</span><span class="s">&quot;News&quot;</span><span class="p">).</span><span class="n">In</span><span class="p">(</span><span class="s">&quot;li.cat-item.cat-item-6 a&quot;</span><span class="p">);</span>
</code></pre>
</div>
<p>.. that opens the page, asserts that the Blogs link exists and clicks it. But if its missing for some reason, perhaps under maintenance, continue on and click on Docs instead. Both of these paths eventually test that the “News” list item exists on the resulting pages. This is essentially branching within a single test based on the pages current state. When run locally, it will behave as the user expects. When parsed for remote execution, the test methods in the catch will never be hit.</p>

<p>With the asynchronous nature of assertions and actions while executing via FluentAutomation.Server, inline code blocks such as the try { } catch() {} can’t be serialized and sent to the server to make that decision. This is the core reason that we have avoided allowing the user to retrieve data from the page into local variables. In general I’d advise against this type of logic because it makes each test more complex than they need to be. If there is an issue you can’t test around with this type of code, its a shortcoming in our framework and I’d love to help you solve these problems. Hit me up via email, comments on the blog or create issues on our GitHub site and we’ll figure out the best path to get you moving forward.</p>

<p>Along with the cons, comes some pretty striking pros in my opinion:</p>

<p><em>Single test, multiple browser execution</em> is baked into the RemoteCommand API at the lowest level. Know exactly how your test executes against any browser without having to mess with different drivers, tools or any of that.</p>

<p>Any automation framework with a compatible AutomationProvider implementation (*Selenium* and <em>WatiN</em> presently) can be used in this manner. No changes to your code required.</p>

<p>Any language that can form valid JSON is supported. First class providers are being built for <em>.NET, JavaScript, CoffeeScript</em> (my new favorite toy), <em>PHP</em> and others. Looking for people willing to help expand the use of the Fluent API to other languages.</p>

<p>Test recording! The contrib project by Paul Zumbrun, (FluentAutomation Recorder)[<a href="https://github.com/pauljz/FluentAutomationRecorder">https://github.com/pauljz/FluentAutomationRecorder</a>] allows tests to be recorded and played back via the chrome extension utilizing the RemoteCommand API.</p>

<p>I think we have a fairly compelling automation story playing out here, but I’d love to hear more feedback from people using or interested in using the Fluent API. The next step for Paul and I is to actually build the documentation we’ve been promising for months. This will take some time to become ‘good’ but I know our users need it.</p>

<p>Thanks for the support!</p>

	
	<nav>
		<div class='right tiles'>
			<a class='author brown' href='//twitter.com/stirno'><img class='gravatar' src='http://www.gravatar.com/avatar/f0911b8dd77a34c0354968639b4545f4' /><span>@stirno</span></a>
			<div>01 March 2012</div>
			<div class='orange' style='margin-right: 0px'>
				<span class='text'>SHARE</span>
			</div>
			<div class='orange' style='padding-left: 0px'>
				<span class='icon-google-plus'></span>
				<span class='icon-twitter'></span>
			</div>
		</div>
	</nav>
	<div class='clear' style='padding-top: 20px'></div>
	
	<div id="disqus_thread"></div>
	<script type="text/javascript">
	var disqus_shortname = 'fluent';
	var disqus_identifier = '/blog/Released-RemoteCommand-API';

	(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</article>
		</section>

		<script type="text/javascript">
			// Disqus
			var disqus_shortname = 'fluent';
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>
	</body>
</html>
